!function(){"use strict";angular.element(document).ready(function(){angular.bootstrap(document.body,["baseApp"])});var e=angular.module("baseApp",["rzModule","mgcrea.ngStrap","ngDialog","ngFileSaver","angularSpinner","pascalprecht.translate"],["$interpolateProvider",function(e){e.startSymbol("[["),e.endSymbol("]]")}]);e.config(["$httpProvider",function(e){e.defaults.headers.common={},e.defaults.headers.post={},e.defaults.headers.put={},e.defaults.headers.patch={},e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}]),e.config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/static/locales/local-",suffix:".json"}).useSanitizeValueStrategy("sanitizeParameters").preferredLanguage("en")}]),e.run(["$rootScope",function(e){e.lang="en"}])}();
angular.module("baseApp").constant("appSettings",{menus:[{name:"Home",url:"/home/",show:!0},{name:"Map Viewer",url:"/mapviewer/",show:!0},{name:"Use Cases",url:"/usecase/",show:!0}],Languages:[{lang:"English",code:"en"},{lang:"Burmese",code:"mm"}],applicationName:"Biophysical M&E Dashboard",footerLinks:[{name:"About",url:"https://servir.adpc.net/about/about-servir-mekong",show:!0},{name:"Tools",url:"https://servir.adpc.net/tools",show:!0},{name:"Geospatial Datasets",url:"https://servir.adpc.net/geospatial-datasets",show:!0},{name:"Resources and Publications",url:"https://servir.adpc.net/publications",show:!0},{name:"News",url:"https://servir.adpc.net/news",show:!0},{name:"Events",url:"https://servir.adpc.net/events",show:!0},{name:"Contact Us",url:"https://servir.adpc.net/about/contact-servir-mekong",show:!0},{name:"Privacy Policy",url:"/privacy-policy/",show:!0}],partnersHeader:[{alt:"The United States Agency for International Development",url:"https://www.usaid.gov/",src:"images/usaid.png",className:"usaid"},{alt:"The National Aeronautics and Space Administration",url:"https://www.nasa.gov/",src:"images/nasa.png",className:"nasa"},{alt:"Asian Disaster Preparedness Center",url:"http://www.adpc.net/",src:"images/adpc.png",className:"adpc"},{alt:"SERVIR",url:"https://servir.adpc.net/",src:"images/servir-mekong.png",className:"servir"}],partnersFooter:[{alt:"Spatial Infomatics Group",url:"https://sig-gis.com/",src:"images/sig.png",className:"partner-sig"},{alt:"Stockholm Environment Institute",url:"https://www.sei-international.org/",src:"images/sei.png",className:"partner-sei"},{alt:"Deltares",url:"https://www.deltares.nl/en/",src:"images/deltares.png",className:"partner-deltares"}],mapboxapi:"pk.eyJ1Ijoic2VydmlybWVrb25nIiwiYSI6ImNrYWMzenhldDFvNG4yeXBtam1xMTVseGoifQ.Wr-FBcvcircZ0qyItQTq9g"});
!function(){"use strict";angular.module("baseApp").controller("mapcontroller",["$scope","$timeout","MapService","appSettings",function(e,t,a,r){function o(e){return parseInt(e)}function n(e){return parseInt(e)}function s(e,t,a){return e=L.tileLayer(t,{attribution:'<a href="https://earthengine.google.com" target="_">Google Earth Engine</a>;',pane:a})}function i(){E.hasLayer(R)&&E.removeLayer(R),E.hasLayer(Ye)&&E.removeLayer(Ye),E.hasLayer(Je)&&E.removeLayer(Je);for(var t=P;t<=T;t++){var a=t.toString();E.hasLayer(je[a].forest)&&E.removeLayer(je[a].forest),E.hasLayer(je[a].forestAlert)&&E.removeLayer(je[a].forestAlert),E.hasLayer(je[a].burnedArea)&&E.removeLayer(je[a].burnedArea)}$("#toggle-list-forest").html(""),$("#toggle-list-evi").html(""),$("#toggle-list-forest-alert").html(""),$("#toggle-list-burned-area").html(""),e.showLoader=!0,g(),f(),m(),v(),b(),_(),u(),y(),A(),w()}function l(e){e.setStyle({weight:5,dashArray:"",fillOpacity:0,color:"yellow"}),L.Browser.ie||L.Browser.opera||e.bringToFront()}function c(e,t){null!==ft&&ft._leaflet_id===e._leaflet_id||t.resetStyle(e)}function d(e,t,a,r){null!==ft&&(ut=ft),E.fitBounds(e.getBounds()),ft=e;var o=e.feature.geometry.coordinates;Ze=qe(o[0][0]),ot=o.length,Qe=r,"protected_area"===r?Ke=e.feature.properties.map_id:"province"===r?Ke=e.feature.properties.gid:"district"===r?Ke=e.feature.properties.DIST_CODE:"country"===r&&(Ke=e.feature.properties.NAME_ENGLI),ut&&c(ut,t),$(".selected_area_name").text(a),Xe=a}function p(e,t,a,r,o,n,s){Highcharts.chart(e,{chart:{type:t,style:{fontFamily:"Roboto Condensed"},width:300,height:200},title:!1,subtitle:!1,xAxis:{categories:a,crosshair:!0},yAxis:{title:{text:null},labels:{formatter:function(){return o?this.value/1e6+"Mha":this.value}}},exporting:{chartOptions:{title:{text:""},subtitle:{text:s}},enabled:!1},credits:{enabled:!1},tooltip:{formatter:function(){return o?this.series.name+" ("+this.point.y+" hectare)":this.series.name+" ("+this.point.y+" evidence)"}},plotOptions:{column:{pointPadding:.2,pointWidth:n,borderWidth:0},series:{stacking:"normal"},bar:{pointWidth:10}},series:r,legend:!1})}function h(e,t,a,r,o,n){$("#"+e).append('<li class="toggle"><label class="switch_layer"><input name="'+t+'" id="'+t+'" data-yid="'+r+'" data-color="#'+n+'" type="checkbox" '+o+'><span class="slider_toggle round"></span></input></label><label>'+a+"</label></li>")}function g(){var t={polygon_id:Ze,refLow:O,refHigh:I,studyLow:P,studyHigh:T,area_id:Ke,area_type:Qe},r=[];a.getPieEvi(t).then(function(e){for(var t=["Large improvement","improvement","No Change","Under Stress","Severe stress"],a=["#264653","#2A9D8F","#E9C46A","#F4A261","#E76F51"],o=0;o<t.length;o++)r.push({name:t[o],y:e[o],color:a[o]});Highcharts.chart("chart",{chart:{type:"pie",width:315,height:300,style:{fontFamily:"Roboto Condensed"}},tooltip:{formatter:function(){return this.point.name+" ("+this.point.percentage.toFixed(2)+"%)"}},credits:{enabled:!1},title:!1,subtitle:!1,plotOptions:{pie:{allowPointSelect:!1,cursor:"pointer",dataLabels:{enabled:!1,format:"",style:{fontFamily:"Roboto Condensed"}},showInLegend:!0}},legend:{layout:"horizontal",align:"left",verticalAlign:"bottom",itemMarginTop:3,itemMarginBottom:3,itemStyle:{color:"#666666",fontWeight:"normal",fontSize:"9px"},labelFormatter:function(){return this.name+" ("+this.percentage.toFixed(2)+"%)"}},exporting:{chartOptions:{title:{text:""},subtitle:{text:"PROPORTION OF BIOPHYSICAL HEALTH IN "+Xe.toUpperCase()}},enabled:!1},series:[{name:"Percent",data:r,showInLegend:!0}]})},function(t){e.showLoader=!1,console.log(t)})}function m(){E.hasLayer(R)&&E.removeLayer(R);var e={polygon_id:Ze,refLow:O,refHigh:I,studyLow:P,studyHigh:T,area_id:Ke,area_type:Qe};a.get_evi_map(e).then(function(e){R=s(R,e.eeMapURL,"EVILayer"),h("toggle-list-evi","EVILayer","Enhanced vegetation index","","","36461F"),$("#EVILayer").change(function(){if(this.checked){R.addTo(E);$(this).attr("data-color");$(this).closest("label").find("span").css("background-color","#36461F")}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(R)&&E.removeLayer(R)}),$("#biophysical-tab").hasClass("active")&&$("#EVILayer").prop("checked",!0).trigger("change")})}function f(){var t={polygon_id:Ze,refLow:O,refHigh:I,studyLow:P,studyHigh:T,area_id:Ke,area_type:Qe};a.getLineEvi(t).then(function(e){var t=[{data:e.timeSeries,name:"Biophysical Health",color:"#2b5154",marker:{enabled:!1,radius:3}}];$("#chart_div").highcharts({chart:{style:{fontFamily:"Roboto Condensed"},type:"spline",width:315,height:280},title:!1,tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>Cumulative anomaly EVI: "+this.point.y.toFixed(2)}},yAxis:{title:{text:"Cumulative anomaly EVI"}},xAxis:{type:"datetime",labels:{format:"{value: %Y-%m-%d}"},title:{text:"Date"}},legend:{align:"center",verticalAlign:"bottom",y:-25},plotOptions:{series:{color:"#2b5154"}},exporting:{chartOptions:{title:{text:""},subtitle:{text:"CUMULATIVE ANOMALY EVI IN "+Xe.toUpperCase()}},enabled:!1},series:t,credits:{enabled:!1}})},function(t){e.showLoader=!1,console.log(t)})}function u(){var e={year:2018,polygon_id:Ze,treeCanopyDefinition:10,treeHeightDefinition:5,startYear:P,endYear:T,type:"forestGainLoss",area_id:Ke,area_type:Qe};a.getForestGainLoss(e).then(function(e){Highcharts.chart("forest_gainloss_chart",{chart:{type:"bar",style:{fontFamily:"Roboto Condensed"},width:300,height:200},title:!1,subtitle:!1,xAxis:{visible:!1},yAxis:{title:{text:null},labels:{formatter:function(){return this.value/1e6+"Mha"}}},plotOptions:{series:{stacking:"normal"}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>Area in hectare: "+Math.abs(this.point.y)}},series:[{name:"Forest Loss",data:[e.forestloss*-1],color:"#73C6B6"},{name:"Forest Gain",data:[e.forestgain],color:"#0B5345"}],exporting:{chartOptions:{title:{text:""},subtitle:{text:"THE CHANGE OF FOREST GAIN AND LOSS IN "+Xe.toUpperCase()}},enabled:!1},credits:{enabled:!1}})})}function y(){var e={year:2018,polygon_id:Ze,treeCanopyDefinition:10,treeHeightDefinition:5,studyLow:P,studyHigh:T,refLow:O,refHigh:I,type:"forestGainLoss",area_id:Ke,area_type:Qe};a.getChangeForestGainLoss(e).then(function(e){var t=(e.statsStudyGain-e.statsRefGain).toFixed(2),a=(e.statsStudyLoss-e.statsRefLoss).toFixed(2);t<0?($("#gain_compared").css("color","red"),$("#gain_compared").text(t)):($("#gain_compared").css("color","green"),$("#gain_compared").text(t)),a<0?($("#loss_compared").css("color","green"),$("#loss_compared").text(a)):($("#loss_compared").css("color","red"),$("#loss_compared").text(a)),$("#loss_compared").text(a),Highcharts.setOptions({lang:{thousandsSep:" "},colors:["#A04000","#117A65"]}),Highcharts.chart("forest_change_gainloss_chart",{chart:{type:"column",style:{fontFamily:"Roboto Condensed"},width:300,height:200},title:!1,subtitle:!1,xAxis:{categories:["BASELINE PERIOD","MEASURING PERIOD"],crosshair:!0},yAxis:{min:0,title:{text:null}},tooltip:{formatter:function(){return this.series.name+" ("+this.point.y.toFixed(2)+")"}},plotOptions:{column:{pointPadding:0,pointWidth:25,borderWidth:0}},series:[{name:"LOSS",data:[e.statsRefLoss,e.statsStudyLoss],color:""},{name:"GAIN",data:[e.statsRefGain,e.statsStudyGain],color:""}],exporting:{enabled:!1},credits:{enabled:!1}})})}function v(){var e={polygon_id:Ze,treeCanopyDefinition:10,treeHeightDefinition:5,startYear:P,endYear:T,type:"forestExtend",area_id:Ke,area_type:Qe};a.getForestMapID(e).then(function(e){for(var t=e,a=[],r=[],o=[],n=P;n<=T;n++){var i=n.toString();o.push(i),a.push(t[i].forest),r.push(t[i].noneForest);var l="forest_"+i;E.createPane(l),E.getPane(l).style.zIndex=300+n,E.hasLayer(je[i].forest)&&E.removeLayer(je[i].forest),je[i].forest=s(je[i].forest,t[i].eeMapURL,l),je[i].forest.setOpacity(1),h("toggle-list-forest","forest_"+i,i,i,"",t[i].color),$("#forest_"+i).change(function(){var e=$(this).attr("data-yid");if(this.checked){var t=$(this).attr("data-color");$(this).closest("label").find("span").css("background-color",t),je[e].forest.addTo(E)}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(je[e].forest)&&E.removeLayer(je[e].forest)})}var c=[{name:"Area in Hectare",data:a,color:"#138D75"}];p("forest_cover_chart","column",o,c,!0,10,"AREA OF FOREST COVER IN "+Xe.toUpperCase());var d=[{name:"Forest",data:a,color:"#138D75"},{name:"Non-Forest",data:r,color:"#919F94"}];p("forest_noneforest_chart","bar",o,d,!0,10,"AREA OF FOREST AND NON-FOREST IN "+Xe.toUpperCase())},function(e){console.log(e)})}function b(){var e={polygon_id:Ze,treeCanopyDefinition:10,treeHeightDefinition:5,startYear:P,endYear:T,area_id:Ke,area_type:Qe};a.getForestGainMapid(e).then(function(e){E.hasLayer(Ye)&&E.removeLayer(Ye),Ye=s(Ye,e.eeMapURL,"ForestGainLayer"),h("toggle-list-forest","ForestGainLayer","Forest Gain","","",e.color),$("#ForestGainLayer").change(function(){if(this.checked){var e=$(this).attr("data-color");$(this).closest("label").find("span").css("background-color",e),Ye.addTo(E)}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(Ye)&&E.removeLayer(Ye)}),$("#forest-monitoring-tab").hasClass("active")&&$("#ForestGainLayer").prop("checked",!0).trigger("change")},function(e){console.log(e)})}function _(){var e={polygon_id:Ze,treeCanopyDefinition:10,treeHeightDefinition:5,startYear:P,endYear:T,area_id:Ke,area_type:Qe};a.getForestLossMapid(e).then(function(e){E.hasLayer(Je)&&E.removeLayer(Je),Je=s(Je,e.eeMapURL,"ForestLossLayer"),h("toggle-list-forest","ForestLossLayer","Forest Loss","","",e.color),$("#ForestLossLayer").change(function(){if(this.checked){var e=$(this).attr("data-color");$(this).closest("label").find("span").css("background-color",e),Je.addTo(E)}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(Je)&&E.removeLayer(Je)}),$("#forest-monitoring-tab").hasClass("active")&&$("#ForestLossLayer").prop("checked",!0).trigger("change")},function(e){console.log(e)})}function A(){var e={polygon_id:Ze,area_id:Ke,area_type:Qe,get_image:!1,startYear:P,endYear:T};a.getForestAlert(e).then(function(e){for(var t=[],a=[],r=0,o=[],n=2019;n<=2020;n++){var i=e[n.toString()],l=n.toString();t.push([n,i.total_area]),a.push([n,i.total_number]),o.push(n),r+=i.total_number;var c="forestAlert_"+l;E.createPane(c),E.getPane(c).style.zIndex=350+n,E.hasLayer(je[l].forestAlert)&&E.removeLayer(je[l].forestAlert),je[l].forestAlert=s(je[l].forestAlert,i.eeMapURL,c),je[l].forestAlert.setOpacity(1),h("toggle-list-forest-alert","forestAlert_"+l,l,l,"",i.color),$("#forestAlert_"+l).change(function(){var e=$(this).attr("data-yid");if(this.checked){var t=$(this).attr("data-color");$(this).closest("label").find("span").css("background-color",t),je[e].forestAlert.addTo(E)}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(je[e].forestAlert)&&E.removeLayer(je[e].forestAlert)})}$("#forest-alert-tab").hasClass("active")&&$("#forestAlert_"+T.toString()).prop("checked",!0).trigger("change");var d=[{name:"Area in Hectare",data:t,color:"#d95252"}];p("forest_alert_area","column",o,d,!0,30,"TOTAL AREA OF FOREST ALERT IN"+Xe.toUpperCase())},function(e){console.log(e)})}function w(){var t={polygon_id:Ze,startYear:P,endYear:T,area_type:Qe,area_id:Ke};a.getBurnedArea(t).then(function(t){for(var a=[],r=[],o=P;o<=T;o++){var n=t[o.toString()],i=o.toString();a.push([o,n.total_area]),r.push(o);var l="burnedArea_"+i;E.createPane(l),E.getPane(l).style.zIndex=380+o,E.hasLayer(je[i].burnedArea)&&E.removeLayer(je[i].burnedArea),je[i].burnedArea=s(je[i].burnedArea,n.eeMapURL,l),je[i].burnedArea.setOpacity(1),h("toggle-list-burned-area","burnedArea_"+i,i,i,"",n.color),$("#burnedArea_"+i).change(function(){var e=$(this).attr("data-yid");if(this.checked){var t=$(this).attr("data-color");$(this).closest("label").find("span").css("background-color",t),je[e].burnedArea.addTo(E)}else $(this).closest("label").find("span").css("background-color","#bbb"),E.hasLayer(je[e].burnedArea)&&E.removeLayer(je[e].burnedArea)})}$("#fire-tab").hasClass("active")&&$("#burnedArea_"+T.toString()).prop("checked",!0).trigger("change");var c=[{name:"Area in Hectare",data:a,color:"#d95252"}];p("burned_area_chart","column",r,c,!0,10,"BURNED AREA IN"+Xe.toUpperCase()),e.showLoader=!1},function(e){console.log(e)})}function x(){document.getElementById("controls"),document.getElementById("collapse-button");$("#collapse-button").hasClass("up")?($("#collapse-button").removeClass("up"),$("#collapse-button").addClass("down"),$("#controls").css("display","none")):($("#collapse-button").removeClass("down"),$("#collapse-button").addClass("up"),$("#controls").css("display","block"))}function k(){$(".modal").removeClass("show"),$(".modal").addClass("hide")}function C(){E.hasLayer(R)&&E.removeLayer(R),E.hasLayer(Ye)&&E.removeLayer(Ye),E.hasLayer(Je)&&E.removeLayer(Je);for(var e=P;e<=T;e++){var t=e.toString();E.hasLayer(je[t].forest)&&E.removeLayer(je[t].forest),E.hasLayer(je[t].forestAlert)&&E.removeLayer(je[t].forestAlert),E.hasLayer(je[t].burnedArea)&&E.removeLayer(je[t].burnedArea)}E.hasLayer(je[2020].forestAlert)&&E.removeLayer(je[2020].forestAlert)}$(".menu-container").css("background-color","#000"),e.showAlert=!1,e.showLoader=!1,e.REFHIGH="",e.REFLOW="",e.STUDYHIGH="",e.STUDYLOW="";var E,F,S,I,O,T,P,R,D,z,G,H,M,N,U,B,V,Y,J,W,X,j,q,Z,K,Q,ee,te,ae,re,oe,ne,se,ie,le,ce,de,pe,he,ge,me,fe,ue,ye,ve,be,$e,_e,Le,Ae,we,xe,ke,Ce,Ee,Fe,Se,Ie,Oe,Te,Pe,Re,De,ze,Ge,He,Me,Ne,Ue,Be,Ve,Ye,Je,We=r.mapboxapi,Xe="Cambodia",je={2000:{forest:D,forestAlert:re,burnedArea:we},2001:{forest:z,forestAlert:oe,burnedArea:xe},2002:{forest:G,forestAlert:ne,burnedArea:ke},2003:{forest:H,forestAlert:se,burnedArea:Ce},2004:{forest:M,forestAlert:ie,burnedArea:Ee},2005:{forest:N,forestAlert:le,burnedArea:Fe},2006:{forest:U,forestAlert:ce,burnedArea:Se},2007:{forest:B,forestAlert:de,burnedArea:Ie},2008:{forest:V,forestAlert:pe,burnedArea:Oe},2009:{forest:Y,forestAlert:he,burnedArea:Te},2010:{forest:J,forestAlert:ge,burnedArea:Pe},2011:{forest:W,forestAlert:me,burnedArea:Re},2012:{forest:X,forestAlert:fe,burnedArea:De},2013:{forest:j,forestAlert:ue,burnedArea:ze},2014:{forest:q,forestAlert:ye,burnedArea:Ge},2015:{forest:Z,forestAlert:ve,burnedArea:He},2016:{forest:K,forestAlert:be,burnedArea:Me},2017:{forest:Q,forestAlert:$e,burnedArea:Ne},2018:{forest:ee,forestAlert:_e,burnedArea:Ue},2019:{forest:te,forestAlert:Le,burnedArea:Be},2020:{forest:ae,forestAlert:Ae,burnedArea:Ve}},qe=function(e){for(var t="",a=0;a<e.length;a++)t+=a!==e.length-1?"("+e[a][1]+","+e[a][0]+"),":"("+e[a][1]+","+e[a][0]+")";return t},Ze="",Ke="",Qe="";$("#measure_period").ionRangeSlider({skin:"round",type:"double",grid:!1,min:o(2002),max:o(2019),from:o(2009),to:o(2019),prettify:n,onChange:function(t){T=t.to,P=t.from,e.STUDYHIGH=T,e.STUDYLOW=P,e.$apply()}}),T=$("#measure_period").data("ionRangeSlider").result.to,P=$("#measure_period").data("ionRangeSlider").result.from,e.STUDYHIGH=T,e.STUDYLOW=P,$("#baseline_period").ionRangeSlider({skin:"round",type:"double",grid:!1,min:o(2002),max:o(2019),from:o(2002),to:o(2008),prettify:n,onChange:function(t){I=t.to,O=t.from,e.REFHIGH=I,e.REFLOW=O}}),I=$("#baseline_period").data("ionRangeSlider").result.to,O=$("#baseline_period").data("ionRangeSlider").result.from,e.REFHIGH=I,e.REFLOW=O;var et=12.75118782414063,tt=104.22877523601562;E=L.map("map",{center:[et,tt],zoom:7,minZoom:2,maxZoom:16,maxBounds:[[-120,-220],[120,220]]}),E.createPane("basemap"),E.getPane("basemap").style.zIndex=0,E.getPane("basemap").style.pointerEvents="none",F=L.tileLayer("https://api.mapbox.com/styles/v1/servirmekong/ckduef35613el19qlsoug6u2h/tiles/256/{z}/{x}/{y}@2x?access_token="+We,{attribution:"",pane:"basemap"}).addTo(E);var at=new L.FeatureGroup;E.addLayer(at);var rt={draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#000",strokeWeight:2,fillOpacity:0}},polyline:!1,circle:!1,circlemarker:!1,rectangle:{shapeOptions:{color:"#fd5a24",strokeWeight:2,fillOpacity:0}},marker:!1},edit:{featureGroup:at,edit:!0}},ot=0,nt=L.Control.extend({options:{position:"topleft"},onAdd:function(e){var t=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return t.innerHTML="<label for='input-file2' style='margin-left:7px;margin-top:5px;font-size:15px;cursor: pointer;' title='Load local file (Geojson, KML)'><span class='glyphicon glyphicon-folder-open' aria-hidden='true'></span><input type='file' class='hide' id='input-file2' accept='.kml,.kmz,.json,.geojson,application/json,application/vnd.google-earth.kml+xml,application/vnd.google-earth.kmz'></label>",t.style.backgroundColor="#f4f4f4",t.style.width="35px",t.style.height="35px",t.style.backgroundSize="30px 30px",t}});E.addControl(new nt);var st=cambodia_polygon.features[0].geometry.coordinates[0][0];Ze=qe(st),Qe="country",Ke="Cambodia",E.createPane("EVILayer"),E.getPane("EVILayer").style.zIndex=300,E.createPane("ForestLossLayer"),E.getPane("ForestLossLayer").style.zIndex=401,E.createPane("ForestGainLayer"),E.getPane("ForestGainLayer").style.zIndex=402,E.createPane("ForestAlertLayer"),E.getPane("ForestAlertLayer").style.zIndex=403,E.createPane("admin"),E.getPane("admin").style.zIndex=999,E.createPane("maplayer_cam"),E.getPane("maplayer_cam").style.zIndex=450,E.getPane("maplayer_cam").style.pointerEvents="none",E.createPane("maplayer_protect"),E.getPane("maplayer_protect").style.zIndex=451,E.getPane("maplayer_protect").style.pointerEvents="none";var it=L.geoJson(protected_area,{style:function(e){return{color:"#222831",fill:!1,opacity:1,clickable:!0,weight:.5}},pane:"maplayer_protect"}),lt=L.geoJson(cam_adm1,{style:function(e){return{color:"#222831",fill:!1,opacity:1,clickable:!0,weight:.5}},pane:"maplayer_cam"}),ct=L.geoJson(cam_adm2,{style:function(e){return{color:"#222831",fill:!1,opacity:1,clickable:!0,weight:.5}},pane:"maplayer_cam"}),dt=L.geoJson(cambodia_polygon,{style:function(e){return{color:"#222831",fill:!1,opacity:1,clickable:!0,weight:2}},pane:"maplayer_cam"}),pt=L.geoJson(protected_area,{style:function(e){return{weight:2,opacity:1,color:"#333",fillOpacity:.1,dashArray:3}},onEachFeature:function(e,t){t.on({mouseover:function(e){l(e.target),$(".highlight_area_textbox").css("display","block"),$(".highlight_area_textbox").text(e.target.feature.properties.name)},mouseout:function(e){c(e.target,pt),$(".highlight_area_textbox").css("display","none")},click:function(e){var t=e.target.feature.properties.name;d(e.target,pt,t,"protected_area")}})},pane:"admin"}),ht=L.geoJson(cam_adm1,{style:function(e){return{weight:2,opacity:1,fillOpacity:.1,color:"#333",dashArray:3}},onEachFeature:function(e,t){t.on({mouseover:function(e){l(e.target),$(".highlight_area_textbox").css("display","block"),$(".highlight_area_textbox").text(e.target.feature.properties.country+"/"+e.target.feature.properties.name)},mouseout:function(e){c(e.target,ht),$(".highlight_area_textbox").css("display","none")},click:function(e){var t=e.target.feature.properties.country+"/"+e.target.feature.properties.name;d(e.target,ht,t,"province")}})},pane:"admin",interactive:!0}),gt=L.geoJson(cam_adm2,{style:function(e){return{weight:2,opacity:1,fillOpacity:.1,color:"#333",dashArray:3}},onEachFeature:function(e,t){t.on({mouseover:function(e){l(e.target),$(".highlight_area_textbox").css("display","block"),$(".highlight_area_textbox").text(e.target.feature.properties.ADM1_NAME+"/"+e.target.feature.properties.ADM2_NAME)},mouseout:function(e){c(e.target,gt),$(".highlight_area_textbox").css("display","none")},click:function(e){var t=e.target.feature.properties.ADM1_NAME+"/"+e.target.feature.properties.ADM2_NAME;d(e.target,gt,t,"district")}})},pane:"admin",interactive:!0}),mt=new L.Control.Draw(rt);E.addControl(mt),E.on("draw:created",function(e){E.hasLayer(pt)&&E.removeLayer(pt),E.hasLayer(gt)&&E.removeLayer(gt),at.clearLayers();var t=(e.layerType,e.layer);E.fitBounds(t.getBounds()),at.addLayer(t);var a=t.toGeoJSON(),r=a.geometry.coordinates;Ze=qe(r[0]),ot=r.length,Qe="draw",Xe="Your Drawing Area"}),E.on("draw:edited",function(e){var t=e.layers;t.eachLayer(function(e){e.toGeoJSON()})}),E.on("draw:deleted",function(e){S=""});var ft=null,ut=null;e.closeAlert=function(){$(".custom-alert").addClass("display-none"),e.alertContent=""};$(document).ready(function(){console.log("ready!"),i(),$("#biophysical-tab").click()}),$("#collapse-button").click(function(){x()}),$(".draw-tab").click(function(){$(".draw-menu").removeClass("hide"),$(".draw-menu").addClass("show"),$(".uploadfile-menu").removeClass("show"),$(".uploadfile-menu").addClass("hide"),$(".draw-upload-tab").removeClass("selected"),$(this).addClass("selected")}),$(".draw-upload-tab").click(function(){$(".draw-menu").removeClass("show"),$(".draw-menu").addClass("hide"),$(".uploadfile-menu").removeClass("hide"),$(".uploadfile-menu").addClass("show"),$(".draw-tab").removeClass("selected"),$(this).addClass("selected")}),$("#draw-tool").click(function(){$("#drawing-modal").removeClass("hide"),$("#drawing-modal").addClass("show"),E.hasLayer(gt)&&E.removeLayer(gt),E.hasLayer(ht)&&E.removeLayer(ht),E.hasLayer(pt)&&E.removeLayer(pt)}),$("#disclaimer-button").click(function(){k(),$("#disclaimer-modal").removeClass("hide"),$("#disclaimer-modal").addClass("show")}),$("#guiding-button").click(function(){k(),$("#guiding-modal").removeClass("hide"),$("#guiding-modal").addClass("show")}),$("#evi-info").click(function(){k(),$("#evi-info-modal").removeClass("hide"),$("#evi-info-modal").addClass("show")}),$("#forest-info").click(function(){k(),$("#forest-info-modal").removeClass("hide"),$("#forest-info-modal").addClass("show")}),$("#forest-alert-info").click(function(){k(),$("#forest-alert-info-modal").removeClass("hide"),$("#forest-alert-info-modal").addClass("show")}),$("#burned-area-info").click(function(){k(),$("#burned-area-info-modal").removeClass("hide"),$("#burned-area-info-modal").addClass("show")}),$("#draw-polygon").click(function(){$(".modal-background").click(),new L.Draw.Polygon(E,mt.options.draw.polygon).enable()}),$("#draw-rectangle").click(function(){$(".modal-background").click(),new L.Draw.Rectangle(E,mt.options.draw.rectangle).enable()}),$("#draw-clear").click(function(){$(".modal-background").click(),at.clearLayers(),$("#btn_download").prop("disabled",!0),$("#btn_download").addClass("btn_custom_disable")}),$(".draw-menu-input").click(function(){$("#input-file2").click()}),$(".close").click(function(){$(".modal-background").click()}),$(".modal-background").click(function(){$(".modal").removeClass("show"),$(".modal").addClass("hide")}),$("input[type=radio][name=basemap_selection]").change(function(){var e=$(this).val();"street"===e?F.setUrl("https://api.mapbox.com/styles/v1/servirmekong/ckduef35613el19qlsoug6u2h/tiles/256/{z}/{x}/{y}@2x?access_token="+We):"satellite"===e?F.setUrl("https://api.mapbox.com/styles/v1/servirmekong/ckecozln92fkk19mjhuoqxhuw/tiles/256/{z}/{x}/{y}@2x?access_token="+We):"terrain"===e&&F.setUrl("http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}")}),$("input[type=checkbox][name=province_toggle]").click(function(){this.checked?lt.addTo(E):E.hasLayer(lt)&&E.removeLayer(lt)}),$("input[type=checkbox][name=district_toggle]").click(function(){this.checked?ct.addTo(E):E.hasLayer(ct)&&E.removeLayer(ct)}),$("input[type=checkbox][name=protected_area_toggle]").click(function(){this.checked?it.addTo(E):E.hasLayer(it)&&E.removeLayer(it)}),$("input[type=checkbox][name=cambodia_toggle]").click(function(){this.checked?dt.addTo(E):E.hasLayer(dt)&&E.removeLayer(dt)}),$(".protected_area_button").click(function(){pt.addTo(E),at.clearLayers(),E.hasLayer(gt)&&E.removeLayer(gt),E.hasLayer(ht)&&E.removeLayer(ht)}),$(".district_button").click(function(){gt.addTo(E),at.clearLayers(),E.hasLayer(pt)&&E.removeLayer(pt),E.hasLayer(ht)&&E.removeLayer(ht)}),$(".province_button").click(function(){ht.addTo(E),at.clearLayers(),E.hasLayer(pt)&&E.removeLayer(pt),E.hasLayer(gt)&&E.removeLayer(gt)}),$(".province_button").click(),$("#zoom-in").click(function(){E.zoomIn()}),$("#zoom-out").click(function(){E.zoomOut()}),$("#legend-toggle").click(function(){"none"===$(".legend").css("display")?$(".legend").show():$(".legend").hide()}),$("#full-screen").click(function(){"90px"===$(".container-wrapper").css("margin-top")?($("nav").hide(),$(".container-wrapper").css("margin-top","0"),$(".c-map-menu .menu-tiles").css("top","0"),$(".c-menu-panel").css("top","0"),$(".map").css("height","100vh"),$(".map-controller").css("top","5px"),$(".highlight_area_textbox").css("top","5px")):($("nav").show(),$(".container-wrapper").css("margin-top","90px"),$(".c-map-menu .menu-tiles").css("top","90px"),$(".c-menu-panel").css("top","90px"),$(".map").css("height","calc(100vh - 90px)"),$(".map-controller").css("top","95px"),$(".highlight_area_textbox").css("top","95px"))}),$(".close-menu").click(function(){$(".map-controller").css("left","80px"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$(".c-menu-panel").css("opacity",0),$("#biophysical-tab").removeClass("active"),$("#basemap-tab").removeClass("active"),$("#forest-monitoring-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$("#layers-tab").removeClass("active"),$("#usecase-tab").removeClass("active")}),$("#biophysical-tab").click(function(){C(),$("#EVILayer").prop("checked",!0).trigger("change"),$(".legend").css("display","block"),$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#forest-monitoring-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$("#fire-tab").removeClass("active"),$("#basemap-tab").removeClass("active"),$("#layers-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel-biophysical").css("transform"," translateX(6.75rem)"),$("#panel-biophysical").css("opacity",1)}),$("#forest-monitoring-tab").click(function(){C(),$("#ForestLossLayer").prop("checked",!0).trigger("change"),$("#ForestGainLayer").prop("checked",!0).trigger("change"),$(".legend").css("display","none"),$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#biophysical-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$("#fire-tab").removeClass("active"),$("#basemap-tab").removeClass("active"),$("#layers-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel-forest-monitoring").css("transform"," translateX(6.75rem)"),$("#panel-forest-monitoring").css("opacity",1)}),$("#forest-alert-tab").click(function(){C(),$("#forestAlert_"+T.toString()).prop("checked",!0).trigger("change"),$(".legend").css("display","none"),$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#biophysical-tab").removeClass("active"),$("#forest-monitoring-tab").removeClass("active"),$("#fire-tab").removeClass("active"),$("#basemap-tab").removeClass("active"),$("#layers-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel-forest-alert").css("transform"," translateX(6.75rem)"),$("#panel-forest-alert").css("opacity",1)}),$("#fire-tab").click(function(){C(),$("#burnedArea_"+T.toString()).prop("checked",!0).trigger("change"),$(".legend").css("display","none"),$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#biophysical-tab").removeClass("active"),$("#forest-monitoring-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel-fire").css("transform"," translateX(6.75rem)"),$("#panel-fire").css("opacity",1)}),$("#basemap-tab").click(function(){$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#forest-monitoring-tab").removeClass("active"),$("#biophysical-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$("#usecase-tab").removeClass("active"),$("#layers-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel3").css("transform"," translateX(6.75rem)"),$("#panel3").css("opacity",1)}),$("#layers-tab").click(function(){$(".close-menu").click(),$(".map-controller").css("left","420px"),$("#forest-monitoring-tab").removeClass("active"),$("#biophysical-tab").removeClass("active"),$("#forest-alert-tab").removeClass("active"),$("#fire-tab").removeClass("active"),$("#usecase-tab").removeClass("active"),$("#basemap-tab").removeClass("active"),$(this).addClass("active"),$(".c-menu-panel").css("transform"," translateX(-60rem)"),$("#panel-layers").css("transform"," translateX(6.75rem)"),$("#panel-layers").css("opacity",1)}),$("#update-map").click(function(){i()}),$("#clear-map").click(function(){at.clearLayers(),E.hasLayer(pt)&&E.removeLayer(pt),E.hasLayer(ht)&&E.removeLayer(ht),E.hasLayer(gt)&&E.removeLayer(gt),E.hasLayer(R)&&E.removeLayer(R),E.hasLayer(Ye)&&E.removeLayer(Ye),E.hasLayer(Je)&&E.removeLayer(Je);for(var e=P;e<=T;e++){var t=e.toString();E.hasLayer(je[t].forest)&&E.removeLayer(je[t].forest),E.hasLayer(je[t].forestAlert)&&E.removeLayer(je[t].forestAlert),E.hasLayer(je[t].burnedArea)&&E.removeLayer(je[t].burnedArea)}$("#toggle-list-forest").html(""),$("#toggle-list-evi").html(""),$("#toggle-list-forest-alert").html(""),$("#toggle-list-burned-area").html("")}),$("#evi_pie_png").click(function(){var e=$("#chart").highcharts();e.exportChart()}),$("#evi_line_png").click(function(){var e=$("#chart_div").highcharts();e.exportChart()}),$("#forest_column_png").click(function(){var e=$("#forest_cover_chart").highcharts();e.exportChart()}),$("#forest_bar_png").click(function(){var e=$("#forest_noneforest_chart").highcharts();e.exportChart()}),$("#forest_gainloss_png").click(function(){var e=$("#forest_gainloss_chart").highcharts();e.exportChart()}),$("#forest_alert_number_png").click(function(){var e=$("#forest_alert_number").highcharts();e.exportChart()}),$("#forest_alert_area_png").click(function(){var e=$("#forest_alert_area").highcharts();e.exportChart()}),$("#burned_area_png").click(function(){var e=$("#burned_area_chart").highcharts();e.exportChart()}),$("#forest_changegainloss_png").click(function(){var e=$("#forest_change_gainloss_chart").highcharts();e.exportChart()}),$("#evi_pie_csv").click(function(){var e=$("#chart").highcharts();e.downloadCSV()}),$("#evi_line_csv").click(function(){var e=$("#chart_div").highcharts();e.downloadCSV()}),$("#forest_column_csv").click(function(){var e=$("#forest_cover_chart").highcharts();e.downloadCSV()}),$("#forest_bar_csv").click(function(){var e=$("#forest_noneforest_chart").highcharts();e.downloadCSV()}),$("#forest_gainloss_csv").click(function(){var e=$("#forest_gainloss_chart").highcharts();e.downloadCSV()}),$("#forest_alert_number_csv").click(function(){var e=$("#forest_alert_number").highcharts();e.downloadCSV()}),$("#forest_alert_area_csv").click(function(){var e=$("#forest_alert_area").highcharts();e.downloadCSV()}),$("#burned_area_csv").click(function(){var e=$("#burned_area_chart").highcharts();e.downloadCSV()}),$("#forest_changegainloss_csv").click(function(){var e=$("#forest_change_gainloss_chart").highcharts();e.downloadCSV()}),$("#export_evi_report").click(function(){e.showLoader=!0;var t=new jsPDF("p","pt","a4"),a=(t.internal.pageSize.getWidth(),t.internal.pageSize.getHeight(),document.getElementById("chart"));t.setFont("helvetica"),t.setFontType("normal"),t.setFontSize(9),domtoimage.toPng(a).then(function(a){var r=new Image;r.src=a;var o=t.splitTextToSize("PROPORTION OF BIOPHYSICAL HEALTH IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,200);t.text(50,20,o),t.addImage(r,"JPEG",50,40,230,190);var n=document.getElementById("chart_div");domtoimage.toPng(n).then(function(a){var r=new Image;r.src=a;var o=t.splitTextToSize("CUMULATIVE ANOMALY EVI IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,200);t.text(290,20,o),t.addImage(r,"JPEG",290,40,230,190),e.showLoader=!1;var n=document.getElementById("map");domtoimage.toPng(n).then(function(a){
var r=new Image;r.src=a,t.addImage(r,"JPEG",50,250,530,410);var o=new Date,n="M&E-REPORT: "+o.toLocaleDateString()+" @ "+o.toLocaleTimeString()+".pdf";t.save(n),e.showLoader=!1})["catch"](function(e){console.error("oops, something went wrong!",e)})})["catch"](function(e){console.error("oops, something went wrong!",e)})})["catch"](function(e){console.error("oops, something went wrong!",e)})}),$("#export_forest_report").click(function(){e.showLoader=!0;var t=new jsPDF("p","pt","a4"),a=(t.internal.pageSize.getWidth(),t.internal.pageSize.getHeight(),document.getElementById("forest_cover_chart"));t.setFont("helvetica"),t.setFontType("normal"),t.setFontSize(9),domtoimage.toPng(a).then(function(a){var r=new Image;r.src=a;var o=t.splitTextToSize("AREA OF FOREST COVER IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,500);t.text(50,20,o),t.addImage(r,"JPEG",50,40,400,300);var n=document.getElementById("forest_noneforest_chart");domtoimage.toPng(n).then(function(a){var r=new Image;r.src=a;var o=t.splitTextToSize("AREA OF FOREST AND NONE FOREST IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,500);t.text(50,380,o),t.addImage(r,"JPEG",50,400,400,300);var n=document.getElementById("forest_change_gainloss_chart");domtoimage.toPng(n).then(function(a){var r=new Image;r.src=a,t.addPage();var o=t.splitTextToSize("THE CHANGE OF FOREST GAIN AND LOSS IN "+Xe.toUpperCase(),500);t.text(50,40,o),o=t.splitTextToSize("Compare the area of forest change between the baseline period  ("+O+" - "+I+") and the measuring period  ("+P+" - "+T+")",500),t.text(50,50,o),t.addImage(r,"JPEG",50,80,400,300),e.showLoader=!1;var n=document.getElementById("map");domtoimage.toPng(n).then(function(a){var r=new Image;r.src=a,t.addImage(r,"JPEG",50,420,450,350);var o=new Date,n="M&E-REPORT: "+o.toLocaleDateString()+" @ "+o.toLocaleTimeString()+".pdf";t.save(n),e.showLoader=!1})["catch"](function(e){console.error("oops, something went wrong!",e)})})})["catch"](function(e){console.error("oops, something went wrong!",e)})})["catch"](function(e){console.error("oops, something went wrong!",e)})}),$("#export_forest_alert_report").click(function(){var e=new jsPDF("p","pt","a4"),t=(e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),document.getElementById("forest_alert_area"));e.setFont("helvetica"),e.setFontType("normal"),e.setFontSize(9),domtoimage.toPng(t).then(function(t){var a=new Image;a.src=t;var r=e.splitTextToSize("TOTAL AREA OF FOREST ALERT IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,500);e.text(50,20,r),e.addImage(a,"JPEG",50,40,400,300);var o=document.getElementById("map");domtoimage.toPng(o).then(function(t){var a=new Image;a.src=t,e.addImage(a,"JPEG",50,400,450,350);var r=new Date,o="M&E-REPORT: "+r.toLocaleDateString()+" @ "+r.toLocaleTimeString()+".pdf";e.save(o)})["catch"](function(e){console.error("oops, something went wrong!",e)})})["catch"](function(e){console.error("oops, something went wrong!",e)})}),$("#export_burned_area_report").click(function(){e.showLoader=!0;var t=new jsPDF("p","pt","a4"),a=(t.internal.pageSize.getWidth(),t.internal.pageSize.getHeight(),document.getElementById("burned_area_chart"));t.setFont("helvetica"),t.setFontType("normal"),t.setFontSize(9),domtoimage.toPng(a).then(function(a){var r=new Image;r.src=a;var o=t.splitTextToSize("BURNED AREA IN "+Xe.toUpperCase()+" FROM "+P+" TO "+T,500);t.text(50,20,o),t.addImage(r,"JPEG",50,40,400,300),e.showLoader=!1;var n=document.getElementById("map");domtoimage.toPng(n).then(function(a){var r=new Image;r.src=a,t.addImage(r,"JPEG",50,360,450,350);var o=new Date,n="M&E-REPORT: "+o.toLocaleDateString()+" @ "+o.toLocaleTimeString()+".pdf";t.save(n),e.showLoader=!1})["catch"](function(e){console.error("oops, something went wrong!",e)})})["catch"](function(e){console.error("oops, something went wrong!",e)})});var yt=function(e){at.clearLayers();var t=e.target.files;if(t.length>1)console.log("upload one file at a time");else{var a=t[0],r=new FileReader;r.readAsText(a),r.onload=function(e){var t,r=e.target.result,o=a.name.split(".").pop().toLowerCase();if(["kml","application/vnd.google-earth.kml+xml","application/vnd.google-earth.kmz"].indexOf(o)>-1){var n;if(window.DOMParser){var s=new DOMParser;n=s.parseFromString(r,"text/xml")}else n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(r);t=toGeoJSON.kml(n)}else try{t=JSON.parse(r)}catch(i){alert("we only accept kml, kmz and geojson")}if(t.features){for(var l=[],c=0;c<t.features.length;c++){var d,p,h,g=[],m=[],f={},u=t.features?t.features[c].geometry:t.geometry;if("Polygon"===u.type){f={},d=u.coordinates[0];for(var y=0;y<d.length;y++)h=[parseFloat(d[y][1]),parseFloat(d[y][0])],g.push(h),m.push([parseFloat(d[y][0]),parseFloat(d[y][1])]);l.push(m),p=new L.polygon(g,{color:"red",weight:2,fillOpacity:0}).addTo(E),at.addLayer(p)}else if("MultiPolygon"===u.type){f={},d=u.coordinates[0][0],m.push(d);for(var v=0;v<d.length;v++)h=[parseFloat(d[v][1]),parseFloat(d[v][0])],g.push(h);l.push(m),p=new L.polygon(g,{color:"red",weight:2,fillOpacity:0}).addTo(E),at.addLayer(p)}else alert("we only accept polygons")}Ze=l,Qe="upload",k()}else alert("Please check your files, there is an error!")}}};$("#input-file2").change(function(e){yt(e)})}])}();
!function(){"use strict";angular.module("baseApp").controller("settingsCtrl",["$scope","appSettings","$translate","$rootScope",function(e,a,s,n){e.menus=a.menus,e.language=a.Languages,e.applicationName=a.applicationName,e.footerLinks=a.footerLinks,e.partnersHeader=a.partnersHeader,e.partnersFooter=a.partnersFooter,e.toggleSidePanel=function(){$("#map").hasClass("pull-margin")?($("#map").toggleClass("pull-margin"),$("#map").css("width","100%"),$("#side-panel").css("width","0"),$("#side-panel").css("left","-25%")):($("#map").toggleClass("pull-margin"),$("#map").css("width","75%"),$("#side-panel").css("width","25%"),$("#side-panel").css("left","0"))},e.changeLanguage=function(e){n.lang=e,s.use(e)},$(".dropdown-toggle").dropdown()}])}();
!function(){"use strict";angular.module("baseApp").service("MapService",["$http","$q",function(e,t){var a=this;a.getMapType=function(e,t,a){var r={getTileUrl:function(a,r){var n="https://earthengine.googleapis.com/map/";return n+=[e,r,a.x,a.y].join("/"),n+="?token="+t},tileSize:new google.maps.Size(256,256),opacity:1,name:a};return new google.maps.ImageMapType(r)},a.getPieEvi=function(t){var a=(t.area_type,t.area_id,{method:"POST",url:"/api/mapclient/",data:{polygon_id:t.polygon_id,refLow:t.refLow,refHigh:t.refHigh,studyLow:t.studyLow,studyHigh:t.studyHigh,area_type:t.area_type,area_id:t.area_id},params:{action:"get-pie-evi"}}),r=e(a).then(function(e){return e.data});return r},a.getLineEvi=function(t){var a={method:"POST",url:"/api/mapclient/",data:{polygon_id:t.polygon_id,refLow:t.refLow,refHigh:t.refHigh,studyLow:t.studyLow,studyHigh:t.studyHigh,area_type:t.area_type,area_id:t.area_id},params:{action:"get-line-evi"}},r=e(a).then(function(e){return e.data});return r},a.get_evi_map=function(t){var a={method:"POST",url:"/api/mapclient/",data:{polygon_id:t.polygon_id,refLow:t.refLow,refHigh:t.refHigh,studyLow:t.studyLow,studyHigh:t.studyHigh,area_type:t.area_type,area_id:t.area_id},params:{action:"get-evi-map"}},r=e(a).then(function(e){return e.data});return r},a.getForestMapID=function(t){var a=t.startYear,r=t.endYear,n=t.polygon_id,i=t.treeCanopyDefinition,o=t.treeHeightDefinition,p=t.type,d={method:"POST",url:"/api/mapclient/",data:{polygon_id:n,type:p,startYear:a,endYear:r,treeCanopyDefinition:i,treeHeightDefinition:o,area_type:t.area_type,area_id:t.area_id},params:{action:"get-forest-extent-map",type:p}},g=e(d).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return g},a.getForestGainMapid=function(t){var a=t.startYear,r=t.endYear,n=t.polygon_id,i=t.treeCanopyDefinition,o=t.treeHeightDefinition,p={method:"POST",url:"/api/mapclient/",data:{polygon_id:n,startYear:a,endYear:r,treeCanopyDefinition:i,treeHeightDefinition:o,area_type:t.area_type,area_id:t.area_id},params:{action:"get-forest-gain-map"}},d=e(p).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return d},a.getForestLossMapid=function(t){var a=t.startYear,r=t.endYear,n=t.polygon_id,i=t.treeCanopyDefinition,o=t.treeHeightDefinition,p={method:"POST",url:"/api/mapclient/",data:{polygon_id:n,startYear:a,endYear:r,treeCanopyDefinition:i,treeHeightDefinition:o,area_type:t.area_type,area_id:t.area_id},params:{action:"get-forest-loss-map"}},d=e(p).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return d},a.getForestGainLoss=function(t){var a=t.year,r=t.startYear,n=t.endYear,i=t.polygon_id,o=t.treeCanopyDefinition,p=t.treeHeightDefinition,d=t.type,g={method:"POST",url:"/api/mapclient/",data:{polygon_id:i,year:a,type:d,startYear:r,endYear:n,treeCanopyDefinition:o,treeHeightDefinition:p,area_type:t.area_type,area_id:t.area_id},params:{action:"get-forestgainloss",type:d}},u=e(g).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return u},a.getChangeForestGainLoss=function(t){var a=t.year,r=t.studyLow,n=t.studyHigh,i=t.refLow,o=t.refHigh,p=t.polygon_id,d=t.treeCanopyDefinition,g=t.treeHeightDefinition,u=t.type,y={method:"POST",url:"/api/mapclient/",data:{polygon_id:p,year:a,type:u,studyLow:r,studyHigh:n,refLow:i,refHigh:o,treeCanopyDefinition:d,treeHeightDefinition:g,area_type:t.area_type,area_id:t.area_id},params:{action:"get-changeforestgainloss",type:u}},l=e(y).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return l},a.getForestAlert=function(t){var a=t.startYear,r=t.endYear,n=t.polygon_id,i=t.get_image,o=t.area_type,p=t.area_id,d={method:"POST",url:"/api/mapclient/",data:{polygon_id:n,get_image:i,startYear:a,endYear:r,area_type:o,area_id:p},params:{action:"get-forest-alert"}},g=e(d).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return g},a.getBurnedArea=function(t){var a=t.startYear,r=t.endYear,n=t.polygon_id,i=t.area_type,o=t.area_id,p={method:"POST",url:"/api/mapclient/",data:{polygon_id:n,startYear:a,endYear:r,area_type:i,area_id:o},params:{action:"get-burned-area"}},d=e(p).then(function(e){return e.data})["catch"](function(e){throw console.log("Error: ",e),e.data});return d},a.removeGeoJson=function(e){e.data.forEach(function(t){e.data.remove(t)})},a.clearLayer=function(e,t){e.overlayMapTypes.forEach(function(a,r){a&&a.name===t&&e.overlayMapTypes.removeAt(r)})},a.clearDrawing=function(e){e&&e.setMap(null)},a.getPolygonBoundArray=function(e){for(var t=[],a=0;a<e.length;a++){var r=[e[a].lng().toFixed(2),e[a].lat().toFixed(2)];t.push(r)}return t},a.getDrawingManagerOptions=function(e){if(!e)return{};var t;"polyline"===e&&(t="polylineOptions");var a={drawingControl:!1};return a.drawingMode=e,a[t]={strokeColor:"#ffff00",strokeWeight:4,fillColor:"yellow",fillOpacity:0,editable:!0},a}}])}();